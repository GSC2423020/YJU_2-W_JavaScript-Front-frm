<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8" />
  <title>Whack-a-Mole</title>
  <style>
    .board {
      display: grid;
      grid-template-columns: repeat(3, 100px);
      gap: 10px;
      margin-bottom: 10px;
    }
    .cell {
      width: 100px;
      height: 100px;
      background: #ddd;
      display: flex;
      justify-content: center;
      align-items: center;
      font-size: 40px;
      cursor: pointer;
      user-select: none;
    }
    .mole {
      background: gold;
    }
  </style>
</head>
<body>

<h2>ë‘ë”ì§€ ì¡ê¸° ê²Œì„</h2>
<div>ì ìˆ˜: <span id="score">0</span></div>
<button id="startBtn">ê²Œì„ ì‹œì‘</button>

<div class="board" id="board"></div>

<script>
  const board = document.getElementById("board");
  const scoreEl = document.getElementById("score");
  const startBtn = document.getElementById("startBtn");

  let score = 0;
  let timer = null;
  let currentIndex = -1;

  // ì…€ ëª©ë¡ì„ ë‹´ì•„ë‘˜ ë°°ì—´(ë˜ëŠ” NodeList)
  let cells = [];

  // 1. ë³´ë“œ ìƒì„± (DOM Create)
  /*
  [ë¬¸ì œ 1]
  - 9ê°œì˜ ì…€(div)ì„ ë™ì ìœ¼ë¡œ ìƒì„±í•˜ì—¬ boardì— ì¶”ê°€í•œë‹¤.
  - ê° ì…€ì— classNameìœ¼ë¡œ "cell"ì„ ì§€ì •í•œë‹¤.
  - ê° ì…€ì— dataset.indexë¡œ 0~8ê¹Œì§€ì˜ ì¸ë±ìŠ¤ë¥¼ ì €ì¥í•œë‹¤.
  - board.appendChild()ë¥¼ ì‚¬ìš©í•˜ì—¬ ìƒì„±í•œ divë¥¼ boardì— ì¶”ê°€í•œë‹¤.

  â€» íŒíŠ¸:
  - document.createElement("div")
  - div.className = "cell"
  - div.dataset.index = i
  - board.appendChild(div)
  */

  function createBoard() {
    // í˜¹ì‹œ ì¬ìƒì„±í•  ìˆ˜ ìˆìœ¼ë‹ˆ ë¹„ìš°ê¸°
    board.innerHTML = "";
    cells = [];

    for (let i = 0; i < 9; i++) {
      const div = document.createElement("div");
      div.className = "cell";
      div.dataset.index = i;

      // í´ë¦­ ì´ë²¤íŠ¸ (ë¬¸ì œ 3ê³¼ ì—°ê²°)
      div.addEventListener("click", handleCellClick);

      board.appendChild(div);
      cells.push(div);
    }
  }

  // 2. ëœë¤ ë‘ë”ì§€ ë“±ì¥
  /*
  [ë¬¸ì œ 2]
  - ëª¨ë“  ì…€ì—ì„œ ë‘ë”ì§€ë¥¼ ì œê±°í•œë‹¤ (mole í´ë˜ìŠ¤ ì œê±°, í…ìŠ¤íŠ¸ ë¹„ìš°ê¸°).
  - 0 ~ 8 ì‚¬ì´ì˜ ëœë¤í•œ ìˆ«ìë¥¼ ìƒì„±í•œë‹¤.
  - ëœë¤í•˜ê²Œ ì„ íƒëœ ì…€ì— "mole" í´ë˜ìŠ¤ë¥¼ ì¶”ê°€í•˜ê³ , ğŸ¹ ì´ëª¨ì§€ë¥¼ í‘œì‹œí•œë‹¤.
  - currentIndex ë³€ìˆ˜ì— í˜„ì¬ ë‘ë”ì§€ ìœ„ì¹˜ë¥¼ ì €ì¥í•œë‹¤.

  â€» íŒíŠ¸:
  - cells.forEach()ë¡œ ëª¨ë“  ì…€ ìˆœíšŒ
  - c.classList.remove("mole"), c.textContent = ""
  - Math.floor(Math.random() * cells.length)
  - cells[rand].classList.add("mole")
  - cells[rand].textContent = "ğŸ¹"
  */
  
  function showMole() {
    // 1) ëª¨ë“  ì…€ ì´ˆê¸°í™”(ë‘ë”ì§€ ì œê±°)
    cells.forEach((c) => {
      c.classList.remove("mole");
      c.textContent = "";
    });

    // 2) ëœë¤ ì¸ë±ìŠ¤ ì„ íƒ
    const rand = Math.floor(Math.random() * cells.length);

    // 3) ì„ íƒëœ ì…€ì— ë‘ë”ì§€ í‘œì‹œ
    cells[rand].classList.add("mole");
    cells[rand].textContent = "ğŸ¹";

    // 4) í˜„ì¬ ìœ„ì¹˜ ì €ì¥
    currentIndex = rand;
  }

  // 3. í´ë¦­ ì´ë²¤íŠ¸ ì²˜ë¦¬
  /*
  [ë¬¸ì œ 3]
  - ëª¨ë“  ì…€ì— í´ë¦­ ì´ë²¤íŠ¸ë¥¼ ë“±ë¡í•œë‹¤.
  - í´ë¦­í•œ ì…€ì˜ ì¸ë±ìŠ¤(dataset.index)ì™€ currentIndexë¥¼ ë¹„êµí•œë‹¤.
  - ë‘ë”ì§€ê°€ ìˆëŠ” ì…€ì„ í´ë¦­í–ˆë‹¤ë©´ scoreë¥¼ 1 ì¦ê°€ì‹œí‚¨ë‹¤.
  - ë³€ê²½ëœ ì ìˆ˜ë¥¼ scoreElì— í‘œì‹œí•œë‹¤.

  â€» íŒíŠ¸:
  - cells.forEach(cell => { ... })
  - cell.addEventListener("click", () => { ... })
  - Number(cell.dataset.index) === currentIndex
  - score++
  - scoreEl.textContent = score
  */
  
  function handleCellClick(e) {
    // í´ë¦­ëœ ì…€
    const cell = e.currentTarget;
    const idx = Number(cell.dataset.index);

    // ë‘ë”ì§€ê°€ ìˆëŠ” ì¹¸ í´ë¦­ ì‹œ ì ìˆ˜ ì¦ê°€
    if (idx === currentIndex) {
      score++;
      scoreEl.textContent = score;

      // (ì„ íƒ) ê°™ì€ ë‘ë”ì§€ë¥¼ ì—°ì†ìœ¼ë¡œ ì ìˆ˜ ëª» ë¨¹ê²Œ ì¦‰ì‹œ ì œê±°
      currentIndex = -1;
      cell.classList.remove("mole");
      cell.textContent = "";
    }
  }

  // 4. ê²Œì„ ì‹œì‘ ë²„íŠ¼
  /*
  [ë¬¸ì œ 4]
  - ì‹œì‘ ë²„íŠ¼ì— í´ë¦­ ì´ë²¤íŠ¸ë¥¼ ë“±ë¡í•œë‹¤.
  - ì´ë¯¸ ê²Œì„ì´ ì§„í–‰ ì¤‘ì´ë©´(timerê°€ ìˆìœ¼ë©´) í•¨ìˆ˜ë¥¼ ì¢…ë£Œí•œë‹¤.
  - ê²Œì„ ì‹œì‘ ì‹œ scoreë¥¼ 0ìœ¼ë¡œ ì´ˆê¸°í™”í•˜ê³  í™”ë©´ì— í‘œì‹œí•œë‹¤.
  - setInterval()ì„ ì‚¬ìš©í•˜ì—¬ 0.8ì´ˆë§ˆë‹¤ showMole() í•¨ìˆ˜ë¥¼ ì‹¤í–‰í•œë‹¤.
  - setTimeout()ì„ ì‚¬ìš©í•˜ì—¬ 10ì´ˆ í›„ ê²Œì„ì„ ì¢…ë£Œí•œë‹¤.
  - ê²Œì„ ì¢…ë£Œ ì‹œ: clearInterval()ë¡œ íƒ€ì´ë¨¸ ì¤‘ì§€, timerë¥¼ nullë¡œ ì´ˆê¸°í™”,
    alert()ë¡œ ìµœì¢… ì ìˆ˜ë¥¼ í‘œì‹œí•œë‹¤.

  â€» íŒíŠ¸:
  - startBtn.addEventListener("click", () => { ... })
  - if (timer) return;
  - timer = setInterval(showMole, 800)
  - setTimeout(() => { ... }, 10000)
  - clearInterval(timer)
  - alert("ê²Œì„ ì¢…ë£Œ! ì ìˆ˜: " + score)
  */
  
  function startGame() {
    // ì´ë¯¸ ì§„í–‰ ì¤‘ì´ë©´ ì¢…ë£Œ
    if (timer) return;

    // ì ìˆ˜ ì´ˆê¸°í™”
    score = 0;
    scoreEl.textContent = score;

    // ì‹œì‘í•˜ìë§ˆì 1ë²ˆ ë³´ì—¬ì£¼ê¸°
    showMole();

    // 0.8ì´ˆë§ˆë‹¤ ë‘ë”ì§€ ë“±ì¥
    timer = setInterval(showMole, 800);

    // 10ì´ˆ í›„ ê²Œì„ ì¢…ë£Œ
    setTimeout(() => {
      clearInterval(timer);
      timer = null;

      // ë§ˆì§€ë§‰ ë‘ë”ì§€ë„ ì§€ìš°ê¸°(ì„ íƒ)
      cells.forEach((c) => {
        c.classList.remove("mole");
        c.textContent = "";
      });
      currentIndex = -1;

      alert("ê²Œì„ ì¢…ë£Œ! ì ìˆ˜: " + score);
    }, 10000);
  }
  
  // ===== ì´ˆê¸°í™” =====
  createBoard();
  startBtn.addEventListener("click", startGame);
</script>

</body>
</html>
